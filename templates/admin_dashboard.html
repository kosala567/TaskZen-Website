{% extends "base.html" %}
{% block title %}Admin{% endblock %}
{% block content %}
  <h3 class="text-white">Admin Dashboard</h3>
  <div class="row">
    <div class="col-md-3"><div class="card bg-dark text-white p-3">Users: <strong>{{ users_count }}</strong></div></div>
    <div class="col-md-3"><div class="card bg-dark text-white p-3">Tasks: <strong>{{ tasks_count }}</strong></div></div>
    <div class="col-md-3"><div class="card bg-dark text-white p-3">Pending Withdraws: <strong>{{ pending_withdraws }}</strong></div></div>
  </div>
  <hr>
  <a class="btn btn-primary" href="{{ url_for('admin_users') }}">Manage Users</a>
  <a class="btn btn-secondary" href="{{ url_for('admin_tasks') }}">Manage Tasks</a>
  <a class="btn btn-info" href="{{ url_for('admin_messages') }}">Messages</a>
  <a class="btn btn-warning" href="{{ url_for('admin_withdraws') }}">Withdraws</a>
{% endblock %}

<!-- Users table with Agent / Partnership approve buttons -->
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Approved</th>
            <th>Partnership</th>
            <th>Agent</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
        <tr>
            <td>{{ user.id }}</td>
            <td>{{ user.username }}</td>
            <td>{{ 'Yes' if user.approved else 'No' }}</td>
            <td>
                {% if user.partnership_request == 0 %}
                <a href="{{ url_for('admin_partnership_approve', uid=user.id) }}" class="btn btn-success btn-sm">Approve</a>
                {% else %}
                Approved
                {% endif %}
            </td>
            <td>
                {% if user.agent_request == 0 %}
                <a href="{{ url_for('admin_agent_approve', uid=user.id) }}" class="btn btn-primary btn-sm">Approve</a>
                {% else %}
                Approved
                {% endif %}
            </td>
            <td>
                <a href="{{ url_for('admin_user_approve', uid=user.id) }}" class="btn btn-success btn-sm">Approve User</a>
                <a href="{{ url_for('admin_user_decline', uid=user.id) }}" class="btn btn-danger btn-sm">Decline User</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
